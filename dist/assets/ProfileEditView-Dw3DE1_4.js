import{d as T,g as o,v as R,c as n,a as l,e as P,t as i,h as H,i as S,H as E,I as L,F as b,k as f,u as W,f as F,w as Z,j as q,n as _,p as J,o as a}from"./index-BB5AZnCh.js";import{B as K,_ as Q}from"./BaseButton-zage8l4P.js";import{L as I}from"./LoadingSpinner-DWGhZI7T.js";import{A as X}from"./AvatarCreator-BBrzZCtX.js";import{a as Y,f as ee,c as se,d as le,u as te}from"./profileService-whAIIfdU.js";const ae={class:"profile-edit"},ne={key:0,class:"loading-container"},oe={key:1,class:"message error"},ie={key:0,class:"message success"},ue={class:"form-section"},ce={class:"form-section"},re={class:"form-section"},de={class:"chips-row"},ve=["onClick"],me={class:"form-section"},he={class:"form-section"},pe={class:"char-count"},be={class:"form-section"},fe={class:"chips-row"},_e=["onClick"],ge={class:"form-section"},ke={class:"semester-row"},ye=["onClick"],Ce={class:"form-section"},we={class:"section-label"},xe={key:0,class:"count"},Ve={class:"chips-container"},Pe=["onClick"],Se={class:"form-section"},Ee={class:"section-label"},Le={key:0,class:"count"},Be={class:"chips-container"},De=["onClick"],Me={class:"form-actions"},Fe={key:1},Ie=T({__name:"ProfileEditView",setup(Ue){const B=q(),x=o(!1),g=o(!1),r=o(null),k=o(null),y=o(""),C=o(""),v=o(null),w=o(""),m=o(""),h=o(null),p=o(null),u=o([]),c=o([]),V=o([]),D=o([]),M=o([]),U=[{value:"MALE",label:"Männlich"},{value:"FEMALE",label:"Weiblich"},{value:"DIVERSE",label:"Divers"}],A=Array.from({length:10},(t,s)=>s+1);function $(t){const s=u.value.indexOf(t);s===-1?u.value.push(t):u.value.splice(s,1)}function j(t){const s=c.value.indexOf(t);s===-1?c.value.push(t):c.value.splice(s,1)}async function z(){x.value=!0,r.value=null;try{const[t,s,e,d]=await Promise.all([Y(),ee(),se(),le()]);V.value=s,D.value=e,M.value=d,N(t)}catch(t){console.error("Fehler beim Laden:",t),r.value="Profil konnte nicht geladen werden"}finally{x.value=!1}}function N(t){y.value=t.vorname||"",C.value=t.profilePictureUrl||"",v.value=t.gender||null,w.value=t.birthdate||"",m.value=t.bio||"",h.value=t.semester||null;const s=V.value.find(e=>e.name===t.course);p.value=s?.id||null,u.value=t.subjects?.map(e=>e.id)||[],c.value=t.languages?.map(e=>e.id)||[]}async function O(){g.value=!0,r.value=null,k.value=null;try{await te({vorname:y.value,profilePictureUrl:C.value,gender:v.value||void 0,birthdate:w.value||void 0,bio:m.value,semester:h.value||void 0,courseId:p.value||void 0,subjectIds:u.value,languageIds:c.value}),k.value="Profil erfolgreich gespeichert!",setTimeout(()=>{B.push("/app")},1500)}catch(t){console.error("Fehler beim Speichern:",t),r.value="Profil konnte nicht gespeichert werden"}finally{g.value=!1}}function G(){B.back()}return R(()=>{z()}),(t,s)=>(a(),n("div",ae,[l("header",{class:"header"},[l("button",{class:"back-btn",onClick:G}," ← Zurück "),s[4]||(s[4]=l("h1",null,"Profil bearbeiten",-1))]),x.value?(a(),n("div",ne,[P(I,{size:"lg"})])):r.value?(a(),n("div",oe,i(r.value),1)):(a(),n("form",{key:2,class:"form",onSubmit:H(O,["prevent"])},[k.value?(a(),n("div",ie,i(k.value),1)):S("",!0),l("section",ue,[s[5]||(s[5]=l("label",{class:"section-label"},"Avatar",-1)),P(X,{modelValue:C.value,"onUpdate:modelValue":s[0]||(s[0]=e=>C.value=e)},null,8,["modelValue"])]),l("section",ce,[s[6]||(s[6]=l("label",{class:"section-label"},"Vorname",-1)),E(l("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>y.value=e),type:"text",placeholder:"Dein Vorname...",class:"input",maxlength:"50"},null,512),[[L,y.value]])]),l("section",re,[s[7]||(s[7]=l("label",{class:"section-label"},"Geschlecht",-1)),l("div",de,[(a(),n(b,null,f(U,e=>l("button",{key:e.value,type:"button",class:_(["chip",{selected:v.value===e.value}]),onClick:d=>v.value=v.value===e.value?null:e.value},i(e.label),11,ve)),64))])]),l("section",me,[s[8]||(s[8]=l("label",{class:"section-label"},"Geburtsdatum",-1)),E(l("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>w.value=e),type:"date",class:"input",max:"2010-01-01",min:"1950-01-01"},null,512),[[L,w.value]])]),l("section",he,[s[9]||(s[9]=l("label",{class:"section-label"},"Über mich",-1)),E(l("textarea",{"onUpdate:modelValue":s[3]||(s[3]=e=>m.value=e),placeholder:"Erzähle etwas über dich...",class:"textarea",maxlength:"500",rows:"4"},null,512),[[L,m.value]]),l("span",pe,i(m.value.length)+" / 500",1)]),l("section",be,[s[10]||(s[10]=l("label",{class:"section-label"},"Studiengang",-1)),l("div",fe,[(a(!0),n(b,null,f(V.value,e=>(a(),n("button",{key:e.id,type:"button",class:_(["chip",{selected:p.value===e.id}]),onClick:d=>p.value=p.value===e.id?null:e.id},i(e.name),11,_e))),128))])]),l("section",ge,[s[11]||(s[11]=l("label",{class:"section-label"},"Semester",-1)),l("div",ke,[(a(!0),n(b,null,f(W(A),e=>(a(),n("button",{key:e,type:"button",class:_(["semester-chip",{selected:h.value===e}]),onClick:d=>h.value=h.value===e?null:e},i(e),11,ye))),128))])]),l("section",Ce,[l("label",we,[s[12]||(s[12]=F(" Fächer ",-1)),u.value.length>0?(a(),n("span",xe," ("+i(u.value.length)+" ausgewählt) ",1)):S("",!0)]),l("div",Ve,[(a(!0),n(b,null,f(D.value,e=>(a(),n("button",{key:e.id,type:"button",class:_(["chip small",{selected:u.value.includes(e.id)}]),onClick:d=>$(e.id)},i(e.name),11,Pe))),128))])]),l("section",Se,[l("label",Ee,[s[13]||(s[13]=F(" Sprachen ",-1)),c.value.length>0?(a(),n("span",Le," ("+i(c.value.length)+" ausgewählt) ",1)):S("",!0)]),l("div",Be,[(a(!0),n(b,null,f(M.value,e=>(a(),n("button",{key:e.id,type:"button",class:_(["chip small",{selected:c.value.includes(e.id)}]),onClick:d=>j(e.id)},i(e.name),11,De))),128))])]),l("div",Me,[P(K,{type:"submit",disabled:g.value,"full-width":""},{default:Z(()=>[g.value?(a(),J(I,{key:0,size:"sm"})):(a(),n("span",Fe,"Speichern"))]),_:1},8,["disabled"])])],32))]))}}),Oe=Q(Ie,[["__scopeId","data-v-12a506db"]]);export{Oe as default};
